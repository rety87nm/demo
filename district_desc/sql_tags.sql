select tl.id, tl.tag, c.nleft, c.nright, c.level, T.hl from comment as c, text_locations as tl LEFT JOIN ( select count(*) as hl, tl.id, tl.tag, c.nleft, c.nright, c.level from comment as c, text_locations as tl, comment as c1 where c1.id_expl IN (20,21,22,23) and tl.id = c.id_expl and c.id_obj = 1 and c.nleft <= c1.nleft  and c.nright >= c1.nright group by tl.id, tl.tag, c.nleft, c.nright, c.level) as T ON T.id = tl.id where tl.id = c.id_expl and c.id_obj = 1 and c.nleft > 1  and c.nright < 40 and c.level = 1 order by c.nleft;
